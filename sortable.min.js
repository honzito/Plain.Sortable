if(window.NodeList&&!NodeList.prototype.forEach){NodeList.prototype.forEach=Array.prototype.forEach}SortableTable=function(table){var me=this;var defaultsort=null;this.table=table;this.rows=[].slice.call(table.tBodies[0].rows);this.headerRow=table.tHead?table.tHead.rows[0]:this.rows.shift();this.headers=this.headerRow.querySelectorAll("th");this.headers.forEach(function(th){var div=document.createElement("div");div.innerHTML=th.innerHTML;div.onclick=function(){me.sortOnColumn(th,div)};th.innerHTML="";th.appendChild(div);if(th.hasAttribute("data-sortdefault")){defaultsort=div}});if(defaultsort){defaultsort.click()}};SortableTable.find=function(sel){document.querySelectorAll(sel||"table.sortable").forEach(function(table){new SortableTable(table)})};SortableTable.prototype.simpleCompare=function(a,b){return a<b?-1:a==b?0:1};SortableTable.prototype.localtextCompare=function(a,b){return a.localeCompare(b)};SortableTable.prototype.compareComposer=function(normalizeFn){var me=this;return function(a,b){return me.simpleCompare(normalizeFn(a),normalizeFn(b))}};SortableTable.prototype.compareFunction=function(sType){switch(sType){case"caseSensitive":return this.localtextCompare;case"integer":return this.compareComposer(function(a){return parseInt(a.replace(/\s/g,"").replace(/^.*?(\d+).*$/,"$1"))});case"float":return this.compareComposer(function(a){return parseFloat(a.replace(/\s/g,"").replace(/^.*?([\d.]+).*$/,"$1"))});case"date":return this.compareComposer(Date.parse);default:return this.localtextCompare}};SortableTable.prototype.getText=function(e){return e.text=e.getAttribute("data-sortval")||e.text||e.textContent||e.innerText||e.innerHTML||""};SortableTable.prototype.getCellText=function(row,pos){row.cellTexts=row.cellTexts||[];if(!row.cellTexts[pos]){try{row.cellTexts[pos]=this.getText(row.querySelectorAll("td,th")[pos])}catch(err){row.cellTexts[pos]="~~~~~~"}}return row.cellTexts[pos]};SortableTable.prototype.sortOnColumn=function(th,span){var pos=[].slice.call(this.headerRow.cells).indexOf(th);this.headers.forEach(function(cell){cell.classList.remove("sortup")});this.headers.forEach(function(cell){cell.classList.remove("sortdown")});var sortFn=this.compareFunction(th.getAttribute("data-sort"));span.order=span.order||1;var me=this;this.rows.sort(function(rowA,rowB){return span.order*sortFn(me.getCellText(rowA,pos),me.getCellText(rowB,pos))});span.order*=-1;th.classList.add(span.order===1?"sortup":"sortdown");var tbody=this.table.tBodies[0];this.rows.forEach(function(row){tbody.appendChild(row)})};